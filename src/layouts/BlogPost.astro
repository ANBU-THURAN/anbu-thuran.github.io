---
import type { CollectionEntry } from 'astro:content';
import Layout from '../components/layout/Layout.astro';

type Props = CollectionEntry<'blog'>['data'] & {
  readingTime: string;
  slug: string;
};

const { title, description, pubDate, updatedDate, tags, image, readingTime } = Astro.props;

const formattedDate = new Intl.DateTimeFormat('en-US', {
  year: 'numeric',
  month: 'long',
  day: 'numeric',
}).format(pubDate);

const formattedUpdatedDate = updatedDate
  ? new Intl.DateTimeFormat('en-US', {
      year: 'numeric',
      month: 'long',
      day: 'numeric',
    }).format(updatedDate)
  : null;
---

<Layout title={title} description={description} image={image}>
  <article class="container mx-auto px-6 py-12">
    <div class="max-w-3xl mx-auto">
      <!-- Header -->
      <header class="mb-8 animate-fade-in">
        <h1 class="font-mono text-3xl font-bold mb-4">{title}</h1>

        <div class="flex flex-wrap items-center gap-2 mb-4">
          <time
            datetime={pubDate.toISOString()}
            class="font-mono text-xs"
            style="color: var(--color-text-secondary);"
          >
            {formattedDate}
          </time>
          <span class="font-mono text-xs" style="color: var(--color-text-secondary);">•</span>
          <span class="font-mono text-xs" style="color: var(--color-text-secondary);">
            {readingTime}
          </span>
          {
            formattedUpdatedDate && (
              <>
                <span class="font-mono text-xs" style="color: var(--color-text-secondary);">•</span>
                <span class="font-mono text-xs" style="color: var(--color-text-secondary);">
                  Updated {formattedUpdatedDate}
                </span>
              </>
            )
          }
        </div>

        {
          tags.length > 0 && (
            <div class="flex flex-wrap gap-1.5">
              {tags.map((tag) => (
                <a href={`/blog?tag=${tag}`} class="tag">
                  #{tag}
                </a>
              ))}
            </div>
          )
        }
      </header>

      <!-- Content -->
      <div class="prose max-w-none animate-fade-in delay-1">
        <slot />
      </div>

      <!-- Footer -->
      <footer class="mt-8 pt-6 animate-fade-in delay-2" style="border-top: 1px solid var(--color-border-subtle);">
        <a
          href="/blog"
          class="font-mono text-xs inline-flex items-center gap-2 hover:opacity-80 transition-opacity"
          style="color: var(--color-accent);"
        >
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M15 19l-7-7 7-7"></path>
          </svg>
          Back to Blog
        </a>
      </footer>
    </div>
  </article>
</Layout>
